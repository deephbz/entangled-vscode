{
    "name": "Entangled Markdown Injection",
    "scopeName": "text.markdown.entangled.injection",
    "injectionSelector": "L:text.html.markdown",
    "patterns": [
        {
            "name": "meta.code.block.entangled",
            "match": "<<([^>]+)>>",
            "captures": {
                "1": { "name": "entity.name.section.reference.entangled" }
            }
        },
        {
            "name": "meta.code.block.entangled",
            "begin": "(^|\\G)(\\s*)(```)(\\{)([.\\w\\-]*)(#[^\\s\\}]+)([^\\}]*)(\\})",
            "beginCaptures": {
                "3": { "name": "punctuation.definition.block" },
                "4": { "name": "punctuation.definition.metadata.begin" },
                "5": { "name": "entity.name.type.language" },
                "6": { "name": "entity.name.section.identifier.entangled" },
                "7": { "name": "meta.embedded.block.attributes" },
                "8": { "name": "punctuation.definition.metadata.end" }
            },
            "end": "(^|\\G)(\\2|\\s{0,3})(```)",
            "endCaptures": {
                "3": { "name": "punctuation.definition.block" }
            },
            "contentName": "meta.embedded.block.entangled"
        }
    ]
}
