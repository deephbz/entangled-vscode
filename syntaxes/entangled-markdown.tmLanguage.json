{
    "name": "Entangled Markdown",
    "scopeName": "text.markdown.entangled",
    "fileTypes": ["md"],
    "patterns": [
        {
            "include": "text.html.markdown"
        },
        {
            "name": "meta.code.block.entangled",
            "begin": "(^|\\G)(\\s*)(```)(\\{)([.\\w\\-]*)(#[^\\s\\}]+)?([^\\}]*)(\\})",
            "beginCaptures": {
                "3": { "name": "punctuation.definition.markdown" },
                "4": { "name": "punctuation.definition.metadata.begin" },
                "5": { "name": "entity.name.type.language" },
                "6": { "name": "entity.name.section.entangled" },
                "7": { "name": "meta.embedded.block.attributes" },
                "8": { "name": "punctuation.definition.metadata.end" }
            },
            "end": "(^|\\G)(\\2|\\s{0,3})(```)",
            "endCaptures": {
                "3": { "name": "punctuation.definition.markdown" }
            },
            "patterns": [
                {
                    "begin": "(^|\\G)(\\s*)(.*)",
                    "while": "(^|\\G)(?!\\s*```)",
                    "contentName": "meta.embedded.block.generic",
                    "patterns": [
                        {
                            "match": "<<([^>]+)>>",
                            "captures": {
                                "1": { "name": "entity.name.function.entangled" }
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "meta.reference.entangled",
            "match": "<<([^>]+)>>",
            "captures": {
                "1": { "name": "entity.name.function.entangled" }
            }
        }
    ]
}
